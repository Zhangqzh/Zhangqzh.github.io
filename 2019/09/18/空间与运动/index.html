<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>空间与运动 | ZZ blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Rica Zhang">
  <meta name="keywords" content="ZZ, ZZ Blog, �ō���Ĳ���">
  <meta name="description" content="Whatever will be, will be.">
  <script id="hexo-configurations">
  var CONFIG = {
    root: '/',
    theme: 'Lx',
    version: '1.4.5',
    localsearch:{
      "enable": false,
      "trigger": "auto",
      "top_n_per_article": 1,
      "unescape": false,
      "preload": false
      },
    path: '-'
  };
</script>

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/main.css">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/jquery.jside.menu.js"></script>
	<script>
	$(document).ready(function(){
	$(".menu-container").jSideMenu({
	    jSidePosition: "position-right",
	    jSideSticky: true,
	    jSideSkin: "endless-river",
	     });
	}); 
	</script>
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300|Noto+Serif+SC&amp;display=swap">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">
</head>
<body>
<div class="single">
<div id="page">
<div id="lx-aside" style="background-image: url(/images/page-cover.jpg)" data-stellar-background-ratio="0.5">
  <div class="overlay">
  <div class="page-title">
    <div class="avatar"><a href="/"><img src="/images/person_1.jpg"></a></div>
    <span>2019-09-18</span>
    <h2>空间与运动</h2>
    
    </div>
</div>
</div>
<div id="lx-main-content">
  <div class="lx-post">
    <div class="lx-entry padding">
      <div>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<h2 id="本文总阅读量次"><a href="#本文总阅读量次" class="headerlink" title="本文总阅读量次"></a><span id="busuanzi_container_page_pv">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</span></h2><h2 id="一-简答并用程序验证【建议做】"><a href="#一-简答并用程序验证【建议做】" class="headerlink" title="一. 简答并用程序验证【建议做】"></a>一. 简答并用程序验证【建议做】</h2><ul>
<li><p><strong>游戏对象运动的本质是什么？</strong></p>
<blockquote>
<p>游戏对象的运动，实质上是游戏对象相对于原点位置的改变，或者相对于其他游戏对象位置的改变，通过transform组件中的position属性数值的改变可以实现游戏对象的运动。  </p>
</blockquote>
</li>
<li><p><strong>请用三种以上的方法实现物体的抛物线运动。（如，修改Transform属性，使用向量Vector3的方法）</strong>    </p>
<ol>
<li><p>直接改变Transform的Position</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">  public float Vx;</span><br><span class="line">  public float Vy;</span><br><span class="line"></span><br><span class="line">  private float nowVy;</span><br><span class="line">  private Transform originTransform;</span><br><span class="line"></span><br><span class="line"> // Use this for initialization</span><br><span class="line">void Start () &#123;</span><br><span class="line">  nowVy = Vy;</span><br><span class="line">  originTransform = this.transform;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> // Update is called once per frame</span><br><span class="line"> void Update () &#123;</span><br><span class="line">  if (nowVy+Vy &gt; 0.00001) &#123;</span><br><span class="line">      this.transform.position += Vector3.up * Time.deltaTime * nowVy;</span><br><span class="line">      this.transform.position += Vector3.left * Time.deltaTime * Vx;</span><br><span class="line">      nowVy -= 10 * Time.deltaTime;       </span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>通过使用Vector3.MoveTowards</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> // Update is called once per frame</span><br><span class="line">void Update () &#123;</span><br><span class="line">  Debug.Log (nowVy + Vy);</span><br><span class="line">  if (nowVy+Vy &gt; 0.00001) &#123;</span><br><span class="line">      Vector3 target = this.transform.position + Vector3.up * Time.deltaTime * nowVy + Vector3.left * Time.deltaTime * Vx;</span><br><span class="line">      this.transform.position = Vector3.MoveTowards (this.transform.position, target, Time.deltaTime);</span><br><span class="line">      nowVy -= 10 * Time.deltaTime;       </span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过使用transform.Translate</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> public float Vx;</span><br><span class="line"> public float Vy;</span><br><span class="line"></span><br><span class="line"> private float nowVy;</span><br><span class="line"> private Vector3 speed;</span><br><span class="line"> private Vector3 Gravity;</span><br><span class="line"></span><br><span class="line"> // Use this for initialization</span><br><span class="line"> void Start () &#123;</span><br><span class="line">  Gravity = Vector3.zero;</span><br><span class="line">  speed = new Vector3 (Vx, Vy, 0);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> // Update is called once per frame</span><br><span class="line"> void Update () &#123;</span><br><span class="line">  if (2*Vy+Gravity.y &gt; 0.00001) &#123;</span><br><span class="line">      Gravity.y -= 10 * Time.fixedDeltaTime;</span><br><span class="line">      this.transform.Translate (speed*Time.fixedDeltaTime);</span><br><span class="line">      this.transform.Translate (Gravity*Time.fixedDeltaTime);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ol>
</li>
</ul>
<p><strong>写一个程序，实现一个完整的太阳系，其他星球围绕太阳转速必须不一样，且不在一个法平面上</strong></p>
<h3 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h3><p>创建游戏对象，并根据太阳系天体图片大致排列出各个星球的位置和大小<br><img src="http://pxcpbo9xv.bkt.clouddn.com/25.png" alt><br>素材是上网找图片就好了<br>所有其他星球是sun的子类，moon又是earth的子类<br>创建script并挂载到sun上，将各个星球拖到对应的transform上<br><img src="http://pxcpbo9xv.bkt.clouddn.com/26.png" alt>  </p>
<h3 id="项目在Github"><a href="#项目在Github" class="headerlink" title="项目在Github"></a>项目在<a href="https://github.com/Zhangqzh/3D-Unity/tree/master/%E7%A9%BA%E9%97%B4%E8%BF%90%E5%8A%A8/%E5%A4%AA%E9%98%B3%E7%B3%BB" target="_blank" rel="noopener">Github</a></h3><h3 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h3><p><img src="http://pxcpbo9xv.bkt.clouddn.com/yes1.gif" alt></p>
<h2 id="二-编程实践"><a href="#二-编程实践" class="headerlink" title="二. 编程实践"></a>二. 编程实践</h2><h3 id="阅读以下游戏脚本"><a href="#阅读以下游戏脚本" class="headerlink" title="阅读以下游戏脚本"></a>阅读以下游戏脚本</h3><blockquote>
<p><em>Priests and Devils<br>      Priests and Devils is a puzzle game in which you will<br>       help the Priests and Devils to cross the river within the time limit.<br>       There are 3 priests and 3 devils at one side of the river.<br>       They all want to get to the other side of this river, but there is only one boat and   this boat can only carry two persons each   time.<br>       And there must be one person steering the boat from one side to the other side.<br>       In the flash game, you can click on them to move them and click the go button to move the boat to the other direction.<br>       If the priests are out numbered by the devils on either side of the river, they get killed and the game is over.<br>       You can try it in many  ways.<br>       Keep all  priests alive! Good luck!</em>  </p>
</blockquote>
<h3 id="程序需要满足的要求"><a href="#程序需要满足的要求" class="headerlink" title="程序需要满足的要求"></a>程序需要满足的要求</h3><ul>
<li>play the game ( <a href="http://www.flash-game.net/game/2535/priests-and-devils.html" target="_blank" rel="noopener">http://www.flash-game.net/game/2535/priests-and-devils.html</a> )</li>
<li>列出游戏中提及的事物（Objects）<br>牧师，魔鬼，船，go按钮，出发岸，结束岸，水  </li>
<li>玩家动作表  </li>
</ul>
<pre><code>|  动作  | 规则  |
|  ----   | ---- |
| 开船  | 船停靠在岸边且穿上至少有一人 |
| 上船  | 船停靠在岸边，船上有空位且岸上有人 |
| 下船  | 船停靠在岸边且船上有人 |  </code></pre><ul>
<li>请将游戏中对象做成预制</li>
<li>在 GenGameObjects 中创建 长方形、正方形、球 及其色彩代表游戏中的对象。</li>
<li>使用 C# 集合类型 有效组织对象</li>
<li>整个游戏仅 主摄像机 和 一个 Empty 对象， 其他对象必须代码动态生成！！！ 。 整个游戏不许出现 Find 游戏对象， SendMessage 这类突破程序结构的 通讯耦合 语句。 违背本条准则，不给分</li>
<li>请使用课件架构图编程，不接受非 MVC 结构程序</li>
<li>注意细节，例如：船未靠岸，牧师与魔鬼上下船运动中，均不能接受用户事件！<h3 id="实现过程-1"><a href="#实现过程-1" class="headerlink" title="实现过程"></a>实现过程</h3> 做好预制（Priests，Devil，Water，Boat,Shore)<br> 可以先去做一些materials，去网上搜图片<br> <img src="http://pxcpbo9xv.bkt.clouddn.com/20.png" alt><br> 然后把对应的material拖到prefab的属性栏里<br> <img src="http://pxcpbo9xv.bkt.clouddn.com/21.png" alt><br> 创建scripts文件夹并编写代码<br> <img src="http://pxcpbo9xv.bkt.clouddn.com/22.png" alt><br> 目录结构如图所示<br> <img src="http://pxcpbo9xv.bkt.clouddn.com/23.png" alt><br> 代码写好后把对应的脚本拖到Scene的Object中，我把ClickGUI拖到了Main Camera下面，然后创建一个空对象并把FirstController拖到下面<br> <img src="http://pxcpbo9xv.bkt.clouddn.com/24.png" alt>  </li>
</ul>
<h3 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h3><h4 id="MVC架构"><a href="#MVC架构" class="headerlink" title="MVC架构"></a>MVC架构</h4><ul>
<li>Model：游戏中的GameObject</li>
<li>View：UserGUI，Click GUI</li>
<li>Controller：SSDirector（最高级别的Controller），FirstController,以及其他基础的Controller（BoatController,MyCharacterController,ShoreController)<h4 id="游戏接口定义"><a href="#游戏接口定义" class="headerlink" title="游戏接口定义"></a>游戏接口定义</h4>游戏中定义了两个接口类型，分别负责场景控制和用户交互，这两个接口不能直接实例化，而是要通过继承这两个接口来实现相应的功能  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public interface SceneController&#123;</span><br><span class="line">void loadResources();</span><br><span class="line">void pause();</span><br><span class="line">void resume();&#125;</span><br><span class="line"></span><br><span class="line">public interface IUserAction&#123;</span><br><span class="line">void moveBoat();</span><br><span class="line">void characterIsClicked(MyCharacterController characterCtrl);</span><br><span class="line">void restart();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="View定义"><a href="#View定义" class="headerlink" title="View定义"></a>View定义</h4><h5 id="ClickGUI"><a href="#ClickGUI" class="headerlink" title="ClickGUI"></a>ClickGUI</h5><p>ClickGUI用来检测用户的点击行为，并利用SceneController中的方法进行处理  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">  public class ClickGUI : MonoBehaviour</span><br><span class="line">  &#123;</span><br><span class="line">    IUserAction action;</span><br><span class="line">    MyCharacterController characterController;</span><br><span class="line"></span><br><span class="line">    public void setController(MyCharacterController characterCtrl)</span><br><span class="line">    &#123;</span><br><span class="line">        characterController = characterCtrl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        action = SSDirector.getInstance().currentSceneController as IUserAction;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void OnMouseDown()</span><br><span class="line">    &#123;</span><br><span class="line">        if (SSDirector.getInstance().state == State.START)</span><br><span class="line">        &#123;</span><br><span class="line">            if (gameObject.name == &quot;boat&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                action.moveBoat();</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                action.characterIsClicked(characterController);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h5 id="UserGUI"><a href="#UserGUI" class="headerlink" title="UserGUI"></a>UserGUI</h5><p>UserGUI 类用来显示游戏中的开始/暂停按钮、游戏状态和倒计时等元素，也是用户控制游戏开始和暂停的入口。  </p>
<h4 id="Controller定义"><a href="#Controller定义" class="headerlink" title="Controller定义"></a>Controller定义</h4><h5 id="BoatController定义"><a href="#BoatController定义" class="headerlink" title="BoatController定义"></a>BoatController定义</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">readonly GameObject boat;//对象</span><br><span class="line">readonly Moveable moveableScript;//控制移动</span><br><span class="line">readonly Vector3 fromPosition = new Vector3(5, 1, 0);//船上的能坐人的位置，右边</span><br><span class="line">readonly Vector3 toPosition = new Vector3(-5, 1, 0);//船上的能做人的位置，左边</span><br><span class="line">readonly Vector3[] from_positions;</span><br><span class="line">readonly Vector3[] to_positions;</span><br><span class="line"></span><br><span class="line">// change frequently</span><br><span class="line">int to_or_from; // to-&gt;-1; from-&gt;1 船在岸的左/右边</span><br><span class="line">MyCharacterController[] passenger = new MyCharacterController[2];//船上的人物</span><br><span class="line"></span><br><span class="line">//----------分割线---------------------</span><br><span class="line">///&lt;summary&gt;</span><br><span class="line">///船的移动，每移动一次改变标志位to_or_from</span><br><span class="line">///&lt;/summary&gt;</span><br><span class="line">    public void Move()</span><br><span class="line">&#123;</span><br><span class="line">    if (to_or_from == -1)</span><br><span class="line">    &#123;</span><br><span class="line">        moveableScript.setDestination(fromPosition);</span><br><span class="line">        to_or_from = 1;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        moveableScript.setDestination(toPosition);</span><br><span class="line">        to_or_from = -1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//----------分割线---------------------</span><br><span class="line"> public int getEmptyIndex()</span><br><span class="line">&#123;</span><br><span class="line">    for (int i = 0; i &lt; passenger.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if (passenger[i] == null)</span><br><span class="line">        &#123;</span><br><span class="line">            return i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return -1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public bool isEmpty()</span><br><span class="line">&#123;</span><br><span class="line">    for (int i = 0; i &lt; passenger.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if (passenger[i] != null)</span><br><span class="line">        &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;//获取船上的空位并判断是否没人</span><br><span class="line"> public Vector3 getEmptyPosition()</span><br><span class="line">&#123;</span><br><span class="line">    Vector3 pos;</span><br><span class="line">    int emptyIndex = getEmptyIndex();</span><br><span class="line">    if (to_or_from == -1)</span><br><span class="line">    &#123;</span><br><span class="line">        pos = to_positions[emptyIndex];</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        pos = from_positions[emptyIndex];</span><br><span class="line">    &#125;</span><br><span class="line">    return pos;</span><br><span class="line">&#125;//获取没人位置的坐标</span><br><span class="line">//----------分割线---------------------</span><br><span class="line">    public void GetOnBoat(MyCharacterController characterCtrl)</span><br><span class="line">&#123;</span><br><span class="line">    int index = getEmptyIndex();</span><br><span class="line">    passenger[index] = characterCtrl;</span><br><span class="line">&#125;//人物对象上船</span><br><span class="line">//----------分割线---------------------</span><br><span class="line"> public MyCharacterController GetOffBoat(string passenger_name)</span><br><span class="line">&#123;</span><br><span class="line">    for (int i = 0; i &lt; passenger.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if (passenger[i] != null &amp;&amp; passenger[i].getName() == passenger_name)</span><br><span class="line">        &#123;</span><br><span class="line">            MyCharacterController charactorCtrl = passenger[i];</span><br><span class="line">            passenger[i] = null;</span><br><span class="line">            return charactorCtrl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Debug.Log(&quot;Cant find passenger in boat: &quot; + passenger_name);</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br><span class="line">//人物对象下船，得到下船人物的名字并返回它的控制器</span><br><span class="line">//----------分割线---------------------</span><br><span class="line">public int[] getCharacterNum()</span><br><span class="line">&#123;</span><br><span class="line">    int[] count = &#123; 0, 0 &#125;;</span><br><span class="line">    for (int i = 0; i &lt; passenger.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        if (passenger[i] == null)</span><br><span class="line">            continue;</span><br><span class="line">        if (passenger[i].getType() == 0)</span><br><span class="line">        &#123;   // 0-&gt;priest, 1-&gt;devil</span><br><span class="line">            count[0]++;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            count[1]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return count;</span><br><span class="line">&#125;//获取船上个身份人物的数量</span><br></pre></td></tr></table></figure>

<h5 id="FirstController"><a href="#FirstController" class="headerlink" title="FirstController"></a>FirstController</h5><ul>
<li>导入游戏资源，搭建游戏场景</li>
<li>处理玩家请求（谁上船，开船，谁下船）</li>
<li>监听游戏是否已经结束  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">//初始化游戏场景和配置</span><br><span class="line">    void Awake()</span><br><span class="line">    &#123;</span><br><span class="line">        SSDirector director = SSDirector.getInstance();</span><br><span class="line">        director.currentSceneController = this;</span><br><span class="line">        userGUI = gameObject.AddComponent&lt;UserGUI&gt;() as UserGUI;</span><br><span class="line">        characters = new MyCharacterController[6];</span><br><span class="line">        director.setFPS(60);</span><br><span class="line">        director.leaveSeconds = director.totalSeconds;</span><br><span class="line">        director.currentSceneController.loadResources();</span><br><span class="line">    &#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">    //创建对象，导入各种预制体资源</span><br><span class="line">    public void loadResources()</span><br><span class="line">    &#123;</span><br><span class="line">        GameObject water = Instantiate(Resources.Load(&quot;Prefabs/Water&quot;,</span><br><span class="line">            typeof(GameObject)), new Vector3(0, 0.5F, 0), Quaternion.identity, null) as GameObject;</span><br><span class="line">        water.name = &quot;water&quot;;</span><br><span class="line">        //设置控制器</span><br><span class="line">        fromShore = new ShoreController(&quot;from&quot;);</span><br><span class="line">        toShore = new ShoreController(&quot;to&quot;);</span><br><span class="line">        boat = new BoatController();</span><br><span class="line">        //导入游戏人物对象并设置控制器</span><br><span class="line">        for (int i = 0; i &lt; 3; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            MyCharacterController cha = new MyCharacterController(&quot;priest&quot;);</span><br><span class="line">            cha.setName(&quot;priest&quot; + i);</span><br><span class="line">            cha.setPosition(fromShore.getEmptyPosition());</span><br><span class="line">            cha.getOnShore(fromShore);</span><br><span class="line">            fromShore.getOnShore(cha);</span><br><span class="line"></span><br><span class="line">            characters[i] = cha;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; 3; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            MyCharacterController cha = new MyCharacterController(&quot;devil&quot;);</span><br><span class="line">            cha.setName(&quot;devil&quot; + i);</span><br><span class="line">            cha.setPosition(fromShore.getEmptyPosition());</span><br><span class="line">            cha.getOnShore(fromShore);</span><br><span class="line">            fromShore.getOnShore(cha);</span><br><span class="line"></span><br><span class="line">            characters[i + 3] = cha;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">```  </span><br><span class="line">```c#</span><br><span class="line">   //如果点了某个人物判断其是在船上还是在岸上，</span><br><span class="line">    //如果在船上就上岸，如果在岸上就下船</span><br><span class="line">    public void characterIsClicked(MyCharacterController characterCtrl)</span><br><span class="line">    &#123;</span><br><span class="line">        if (characterCtrl.isOnBoat())</span><br><span class="line">        &#123;</span><br><span class="line">            ShoreController whichShore;</span><br><span class="line">            if (boat.get_to_or_from() == -1)</span><br><span class="line">            &#123; // to-&gt;-1; from-&gt;1</span><br><span class="line">                whichShore = toShore;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                whichShore = fromShore;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            boat.GetOffBoat(characterCtrl.getName());</span><br><span class="line">            characterCtrl.moveToPosition(whichShore.getEmptyPosition());</span><br><span class="line">            characterCtrl.getOnShore(whichShore);</span><br><span class="line">            whichShore.getOnShore(characterCtrl);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;                                   // character on shore</span><br><span class="line">            ShoreController whichShore = characterCtrl.getShoreController();</span><br><span class="line"></span><br><span class="line">            if (boat.getEmptyIndex() == -1)</span><br><span class="line">            &#123;       // boat is full</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (whichShore.get_to_or_from() != boat.get_to_or_from())   // boat is not on the side of character</span><br><span class="line">                return;</span><br><span class="line"></span><br><span class="line">            whichShore.getOffShore(characterCtrl.getName());</span><br><span class="line">            characterCtrl.moveToPosition(boat.getEmptyPosition());</span><br><span class="line">            characterCtrl.getOnBoat(boat);</span><br><span class="line">            boat.GetOnBoat(characterCtrl);</span><br><span class="line">        &#125;</span><br><span class="line">        userGUI.status = check_game_over();</span><br><span class="line">    &#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line"> int check_game_over()</span><br><span class="line">    &#123;   // 0-&gt;not finish, 1-&gt;lose, 2-&gt;win</span><br><span class="line">        int from_priest = 0;</span><br><span class="line">        int from_devil = 0;</span><br><span class="line">        int to_priest = 0;</span><br><span class="line">        int to_devil = 0;</span><br><span class="line">        //获取右边对应的人数</span><br><span class="line">        int[] fromCount = fromShore.getCharacterNum();</span><br><span class="line">        from_priest += fromCount[0];</span><br><span class="line">        from_devil += fromCount[1];</span><br><span class="line">        //获取左边对应的人数</span><br><span class="line">        int[] toCount = toShore.getCharacterNum();</span><br><span class="line">        to_priest += toCount[0];</span><br><span class="line">        to_devil += toCount[1];</span><br><span class="line">        //如果左边有六个人就是安全过河，即游戏胜利</span><br><span class="line">        if (to_priest + to_devil == 6)      // win</span><br><span class="line">            return 2;</span><br><span class="line">        //船上的人数目加上去</span><br><span class="line">        int[] boatCount = boat.getCharacterNum();</span><br><span class="line">        if (boat.get_to_or_from() == -1)</span><br><span class="line">        &#123;   // boat at toShore</span><br><span class="line">            to_priest += boatCount[0];</span><br><span class="line">            to_devil += boatCount[1];</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;   // boat at fromShore</span><br><span class="line">            from_priest += boatCount[0];</span><br><span class="line">            from_devil += boatCount[1];</span><br><span class="line">        &#125;</span><br><span class="line">        //如果任意一边的牧师人数少于魔鬼就是输了</span><br><span class="line">        //如果时间结束仍没有胜利，就是未完成游戏</span><br><span class="line">        if (from_priest &lt; from_devil &amp;&amp; from_priest &gt; 0)</span><br><span class="line">        &#123;       // lose</span><br><span class="line">            return 1;</span><br><span class="line">        &#125;</span><br><span class="line">        if (to_priest &lt; to_devil &amp;&amp; to_priest &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            return 1;</span><br><span class="line">        &#125;</span><br><span class="line">        return 0;           // not finish</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="其他具体的controller不再一一介绍"><a href="#其他具体的controller不再一一介绍" class="headerlink" title="其他具体的controller不再一一介绍"></a>其他具体的controller不再一一介绍</h5><h3 id="实现效果-1"><a href="#实现效果-1" class="headerlink" title="实现效果"></a>实现效果</h3><p><a href="http://pxcpbo9xv.bkt.clouddn.com/20190918_155211.mp4" target="_blank" rel="noopener">视频链接</a></p>
<h3 id="代码链接"><a href="#代码链接" class="headerlink" title="代码链接"></a>代码链接</h3><p><a href="https://github.com/Zhangqzh/3D-Unity/tree/master/%E7%A9%BA%E9%97%B4%E8%BF%90%E5%8A%A8/%E7%89%A7%E5%B8%88%E5%92%8C%E9%AD%94%E9%AC%BC" target="_blank" rel="noopener">Github</a></p>

      </div>
    </div>
  </div>
</div>
<div class="lx-navigation">
	<div class="lx-cover prev lx-cover-sm" style="background-image: url(/images/footer_1.jpg)">
		<div class="overlay"></div>
		<a class="copy" href="#">
			<div class="display-t">
				<div class="display-tc">
					<div>
						<span>Next</span>
						<h3>没有更新的文章</h3>
					</div>
				</div>
			</div>
		</a>
	</div>
        <div class="lx-cover next lx-cover-sm" style="background-image: url(/images/footer_2.jpg)">
		<div class="overlay"></div>
		<a class="copy" href="/2019/09/12/执行go程序和创建包/">
			<div class="display-t">
				<div class="display-tc">
					<div>
						<span>Prev</span>
						<h3>执行go程序和创建包</h3>
					</div>
				</div>
			</div>
		</a>
	</div>
</div>
</div>

<footer>
  <div>
  Copyright &copy; 2019.<a href="/">ZZ blog</a><br>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://lx.blleng.cn" target="_blank">Lx</a><br>
  </div>
</footer>
</div>

<button class="menu-trigger"></button>
<div class="menu">
  <div class="menu-head">
    <span class="layer">
      <div class="col">
        <div class="row for-pic">
          <div class="profile-pic">
            <a href="/"><img src="/images/person_1.jpg" alt="Rica Zhang"></a>
          </div>
        </div>
        <div class="row for-name">
          <p>Rica Zhang</p>
          <span class="tagline">Hello, World!</span>
        </div>
      </div>
    </span>
  </div>
  <nav class="menu-container">
  <ul class="menu-items">
    <li><a href="/"><i class="fa fa-home fa-fw"></i>首页</a></li>
    <li><a href="/archives/"><i class="fa fa-archive fa-fw"></i>归档</a></li>
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-bookmark fa-fw"></i>页面</span>
        <ul>
          <li><a href="/guestbook">留言</a></li>
        <li><a href="/about">关于</a></li>
        </ul>
    </li>
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-link fa-fw"></i>友链</span>
        <ul>
          <li> <a href="https://lx.blleng.cn" target="_blank">Theme-Lx</a></li>
        </ul>
    </li>
  </ul>
  </nav>
</div>

<div class="gototop js-top">
  <a href="#" class="js-gotop"><i class="fa fa-arrow-up"></i></a>
</div>
<script src="/js/jquery.easing.min.js"></script>
<script src="/js/jquery.waypoints.min.js"></script>
<script src="/js/jquery.stellar.min.js"></script>
<script src="/js/main.js"></script>


</body>
</html>
